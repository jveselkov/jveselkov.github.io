var app=function(){"use strict";function t(){}const n=t=>t;function e(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(e)}function l(t){return"function"==typeof t}function i(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function c(t){return null==t?"":t}const s="undefined"!=typeof window;let u=s?()=>window.performance.now():()=>Date.now(),f=s?t=>requestAnimationFrame(t):t;const h=new Set;function a(t){h.forEach(n=>{n.c(t)||(h.delete(n),n.f())}),0!==h.size&&f(a)}function d(t){let n;return 0===h.size&&f(a),{promise:new Promise(e=>{h.add(n={c:t,f:e})}),abort(){h.delete(n)}}}function p(t,n){t.appendChild(n)}function g(t,n,e){t.insertBefore(n,e||null)}function m(t){t.parentNode.removeChild(t)}function $(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function y(t){return document.createElement(t)}function x(t){return document.createTextNode(t)}function v(){return x(" ")}function w(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function b(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function _(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}const I=new Set;let k,E=0;function D(t,n,e,o,r,l,i,c=0){const s=16.666/o;let u="{\n";for(let t=0;t<=1;t+=s){const o=n+(e-n)*l(t);u+=100*t+`%{${i(o,1-o)}}\n`}const f=u+`100% {${i(e,1-e)}}\n}`,h=`__svelte_${function(t){let n=5381,e=t.length;for(;e--;)n=(n<<5)-n^t.charCodeAt(e);return n>>>0}(f)}_${c}`,a=t.ownerDocument;I.add(a);const d=a.__svelte_stylesheet||(a.__svelte_stylesheet=a.head.appendChild(y("style")).sheet),p=a.__svelte_rules||(a.__svelte_rules={});p[h]||(p[h]=!0,d.insertRule(`@keyframes ${h} ${f}`,d.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?g+", ":""}${h} ${o}ms linear ${r}ms 1 both`,E+=1,h}function N(t,n){const e=(t.style.animation||"").split(", "),o=e.filter(n?t=>t.indexOf(n)<0:t=>-1===t.indexOf("__svelte")),r=e.length-o.length;r&&(t.style.animation=o.join(", "),E-=r,E||f(()=>{E||(I.forEach(t=>{const n=t.__svelte_stylesheet;let e=n.cssRules.length;for(;e--;)n.deleteRule(e);t.__svelte_rules={}}),I.clear())}))}function C(t){k=t}function F(){const t=function(){if(!k)throw new Error("Function called outside component initialization");return k}();return(n,e)=>{const o=t.$$.callbacks[n];if(o){const r=_(n,e);o.slice().forEach(n=>{n.call(t,r)})}}}const M=[],q=[],A=[],S=[],O=Promise.resolve();let j=!1;function z(t){A.push(t)}let B=!1;const P=new Set;function R(){if(!B){B=!0;do{for(let t=0;t<M.length;t+=1){const n=M[t];C(n),U(n.$$)}for(M.length=0;q.length;)q.pop()();for(let t=0;t<A.length;t+=1){const n=A[t];P.has(n)||(P.add(n),n())}A.length=0}while(M.length);for(;S.length;)S.pop()();j=!1,B=!1,P.clear()}}function U(t){if(null!==t.fragment){t.update(),r(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(z)}}let L;function T(){return L||(L=Promise.resolve(),L.then(()=>{L=null})),L}function W(t,n,e){t.dispatchEvent(_(`${n?"intro":"outro"}${e}`))}const G=new Set;let H;function J(){H={r:0,c:[],p:H}}function K(){H.r||r(H.c),H=H.p}function Q(t,n){t&&t.i&&(G.delete(t),t.i(n))}function V(t,n,e,o){if(t&&t.o){if(G.has(t))return;G.add(t),H.c.push(()=>{G.delete(t),o&&(e&&t.d(1),o())}),t.o(n)}}const X={duration:0};function Y(t){t&&t.c()}function Z(t,n,o){const{fragment:i,on_mount:c,on_destroy:s,after_update:u}=t.$$;i&&i.m(n,o),z(()=>{const n=c.map(e).filter(l);s?s.push(...n):r(n),t.$$.on_mount=[]}),u.forEach(z)}function tt(t,n){const e=t.$$;null!==e.fragment&&(r(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function nt(t,n){-1===t.$$.dirty[0]&&(M.push(t),j||(j=!0,O.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function et(n,e,l,i,c,s,u=[-1]){const f=k;C(n);const h=e.props||{},a=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:o(),dirty:u};let d=!1;if(a.ctx=l?l(n,h,(t,e,...o)=>{const r=o.length?o[0]:e;return a.ctx&&c(a.ctx[t],a.ctx[t]=r)&&(a.bound[t]&&a.bound[t](r),d&&nt(n,t)),e}):[],a.update(),d=!0,r(a.before_update),a.fragment=!!i&&i(a.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);a.fragment&&a.fragment.l(t),t.forEach(m)}else a.fragment&&a.fragment.c();e.intro&&Q(n.$$.fragment),Z(n,e.target,e.anchor),R()}C(f)}class ot{$destroy(){tt(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}function rt(t,{delay:e=0,duration:o=400,easing:r=n}){const l=+getComputedStyle(t).opacity;return{delay:e,duration:o,easing:r,css:t=>"opacity: "+t*l}}function lt(e){let o,i,s,f,h;return{c(){o=y("div"),b(o,"style",e[1]),b(o,"class",i=c(e[2])+" svelte-mvxghu")},m(t,n){g(t,o,n),h=!0},p(t,n){(!h||2&n)&&b(o,"style",t[1]),(!h||4&n&&i!==(i=c(t[2])+" svelte-mvxghu"))&&b(o,"class",i)},i(e){h||(z(()=>{f&&f.end(1),s||(s=function(e,o,r){let i,c,s=o(e,r),f=!1,h=0;function a(){i&&N(e,i)}function p(){const{delay:o=0,duration:r=300,easing:l=n,tick:p=t,css:g}=s||X;g&&(i=D(e,0,1,r,o,l,g,h++)),p(0,1);const m=u()+o,$=m+r;c&&c.abort(),f=!0,z(()=>W(e,!0,"start")),c=d(t=>{if(f){if(t>=$)return p(1,0),W(e,!0,"end"),a(),f=!1;if(t>=m){const n=l((t-m)/r);p(n,1-n)}}return f})}let g=!1;return{start(){g||(N(e),l(s)?(s=s(),T().then(p)):p())},invalidate(){g=!1},end(){f&&(a(),f=!1)}}}(o,rt,{duration:250})),s.start()}),h=!0)},o(e){s&&s.invalidate(),f=function(e,o,i){let c,s=o(e,i),f=!0;const h=H;function a(){const{delay:o=0,duration:l=300,easing:i=n,tick:a=t,css:p}=s||X;p&&(c=D(e,1,0,l,o,i,p));const g=u()+o,m=g+l;z(()=>W(e,!1,"start")),d(t=>{if(f){if(t>=m)return a(0,1),W(e,!1,"end"),--h.r||r(h.c),!1;if(t>=g){const n=i((t-g)/l);a(1-n,n)}}return f})}return h.r+=1,l(s)?T().then(()=>{s=s(),a()}):a(),{end(t){t&&s.tick&&s.tick(1,0),f&&(c&&N(e,c),f=!1)}}}(o,rt,{}),h=!1},d(t){t&&m(o),t&&f&&f.end()}}}function it(t){let n,e,o,r,l=t[0]&&lt(t);return{c(){n=y("div"),l&&l.c(),b(n,"class","field svelte-mvxghu")},m(i,c){g(i,n,c),l&&l.m(n,null),e=!0,o||(r=w(n,"click",t[3]),o=!0)},p(t,[e]){t[0]?l?(l.p(t,e),1&e&&Q(l,1)):(l=lt(t),l.c(),Q(l,1),l.m(n,null)):l&&(J(),V(l,1,1,()=>{l=null}),K())},i(t){e||(Q(l),e=!0)},o(t){V(l),e=!1},d(t){t&&m(n),l&&l.d(),o=!1,r()}}}function ct(t,n,e){let{color:o}=n,{selected:r}=n;const l=F();let i,c;return t.$set=t=>{"color"in t&&e(0,o=t.color),"selected"in t&&e(4,r=t.selected)},t.$$.update=()=>{1&t.$$.dirty&&e(1,i=void 0!==o?`background: radial-gradient(circle at 0.5em 0.5em, var(--ball-color-${o}), #000);`:""),17&t.$$.dirty&&e(2,c=void 0!==o?"ball filled"+(r?" bounce":""):"ball")},[o,i,c,function(){l(o?"cell-click":"empty-cell-click")},r]}class st extends ot{constructor(t){super(),et(this,t,ct,it,i,{color:0,selected:4})}}function ut(t){this.content=[],this.scoreFunction=t}function ft(t,n,e){this.x=t,this.y=n,this.weight=e}function ht(t,n){n=n||{},this.nodes=[],this.diagonal=!!n.diagonal,this.grid=[];for(let n=0;n<t.length;n++){this.grid[n]=[];for(let e=0,o=t[n];e<o.length;e++){let t=new ft(n,e,o[e]);this.grid[n][e]=t,this.nodes.push(t)}}this.init()}function at(t){let n=t;const e=[];for(;n.parent;)e.unshift(n),n=n.parent;return e}ut.prototype={push(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop(){let t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t},remove(t){let n=this.content.indexOf(t),e=this.content.pop();n===this.content.length-1&&(this.content[n]=e,this.scoreFunction(e)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))},size(){return this.content.length},rescoreElement(t){this.sinkDown(this.content.indexOf(t))},sinkDown(t){let n=this.content[t];for(;t>0;){let e=(t+1>>1)-1,o=this.content[e];if(!(this.scoreFunction(n)<this.scoreFunction(o)))break;this.content[e]=n,this.content[t]=o,t=e}},bubbleUp(t){let n=this.content.length,e=this.content[t],o=this.scoreFunction(e);for(;;){let r,l=t+1<<1,i=l-1,c=null;if(i<n){let t=this.content[i];r=this.scoreFunction(t),r<o&&(c=i)}if(l<n){let t=this.content[l];this.scoreFunction(t)<(null===c?o:r)&&(c=l)}if(null===c)break;this.content[t]=this.content[c],this.content[c]=e,t=c}}},ft.prototype.toString=function(){return`[${this.x} ${this.y}]`},ft.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},ft.prototype.isWall=function(){return 0===this.weight},ht.prototype.init=function(){this.dirtyNodes=[];for(let t=0;t<this.nodes.length;t++)dt.cleanNode(this.nodes[t])},ht.prototype.cleanDirty=function(){for(let t=0;t<this.dirtyNodes.length;t++)dt.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},ht.prototype.markDirty=function(t){this.dirtyNodes.push(t)},ht.prototype.neighbors=function(t){const n=[],e=t.x,o=t.y,r=this.grid;return r[e-1]&&r[e-1][o]&&n.push(r[e-1][o]),r[e+1]&&r[e+1][o]&&n.push(r[e+1][o]),r[e]&&r[e][o-1]&&n.push(r[e][o-1]),r[e]&&r[e][o+1]&&n.push(r[e][o+1]),this.diagonal?(r[e-1]&&r[e-1][o-1]&&n.push(r[e-1][o-1]),r[e+1]&&r[e+1][o-1]&&n.push(r[e+1][o-1]),r[e-1]&&r[e-1][o+1]&&n.push(r[e-1][o+1]),r[e+1]&&r[e+1][o+1]&&n.push(r[e+1][o+1]),n):n},ht.prototype.toString=function(){const t=[],n=this.grid;for(let e=0;e<n.length;e++){const o=[],r=n[e];for(let t=0;t<r.length;t++)o.push(r[t].weight);t.push(o.join(" "))}return t.join("\n")};const dt={search(t,n,e,o){t.cleanDirty();let r=(o=o||{}).heuristic||dt.heuristics.manhattan,l=o.closest||!1,i=new ut(t=>t.f),c=n;for(n.h=r(n,e),t.markDirty(n),i.push(n);i.size()>0;){let n=i.pop();if(n===e)return at(n);n.closed=!0;let o=t.neighbors(n);for(let s=0,u=o.length;s<u;++s){let u=o[s];if(u.closed||u.isWall())continue;let f=n.g+u.getCost(n),h=u.visited;(!h||f<u.g)&&(u.visited=!0,u.parent=n,u.h=u.h||r(u,e),u.g=f,u.f=u.g+u.h,t.markDirty(u),l&&(u.h<c.h||u.h===c.h&&u.g<c.g)&&(c=u),h?i.rescoreElement(u):i.push(u))}}return l?at(c):[]},heuristics:{manhattan:(t,n)=>Math.abs(n.x-t.x)+Math.abs(n.y-t.y),diagonal(t,n){let e=Math.sqrt(2),o=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y);return 1*(o+r)+(e-2)*Math.min(o,r)}},cleanNode(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function pt(t,n){let e=t-.5+Math.random()*(n-t+1);return Math.round(e)}function gt(t,n,e,o){const r=[...t[n]];return r[e]=o,t[n]=r,t}function mt(t,n){let e,o;do{e=pt(0,8),o=pt(0,8)}while(void 0!==t[e][o]);return gt(t,e,o,n)}function $t(t){return mt(t,pt(1,5))}function yt(){const t=[];for(let n=0;n<3;n++)t.push(pt(1,5));return t}function xt(){return function(t,n){let e=t;for(let t=0;t<n;t++)e=$t(e);return e}(new Array(9).fill(new Array(9).fill(void 0)),5)}function vt(t,n,e){const o=t.slice();return o[15]=n[e],o[17]=e,o}function wt(t,n,e){const o=t.slice();return o[12]=n[e],o[14]=e,o}function bt(t,n,e){const o=t.slice();return o[18]=n[e],o}function _t(t){let n;const e=new st({props:{color:t[18]}});return{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.color=t[18]),e.$set(o)},i(t){n||(Q(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){tt(e,t)}}}function It(t){let n;const e=new st({props:{color:t[15],selected:t[0].rowIndex===t[14]&&t[0].cellIndex===t[17]}});return e.$on("cell-click",(function(...n){return t[10](t[14],t[17],...n)})),e.$on("empty-cell-click",(function(...n){return t[11](t[14],t[17],...n)})),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(n,o){t=n;const r={};2&o&&(r.color=t[15]),1&o&&(r.selected=t[0].rowIndex===t[14]&&t[0].cellIndex===t[17]),e.$set(r)},i(t){n||(Q(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){tt(e,t)}}}function kt(t){let n,e,o,r=t[12],l=[];for(let n=0;n<r.length;n+=1)l[n]=It(vt(t,r,n));const i=t=>V(l[t],1,1,()=>{l[t]=null});return{c(){n=y("div");for(let t=0;t<l.length;t+=1)l[t].c();e=v(),b(n,"class","row svelte-qae3di")},m(t,r){g(t,n,r);for(let t=0;t<l.length;t+=1)l[t].m(n,null);p(n,e),o=!0},p(t,o){if(99&o){let c;for(r=t[12],c=0;c<r.length;c+=1){const i=vt(t,r,c);l[c]?(l[c].p(i,o),Q(l[c],1)):(l[c]=It(i),l[c].c(),Q(l[c],1),l[c].m(n,e))}for(J(),c=r.length;c<l.length;c+=1)i(c);K()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)Q(l[t]);o=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)V(l[t]);o=!1},d(t){t&&m(n),$(l,t)}}}function Et(t){let n,e,o,r,l,i,c,s,u,f,h,a,d=t[3],_=[];for(let n=0;n<d.length;n+=1)_[n]=_t(bt(t,d,n));const I=t=>V(_[t],1,1,()=>{_[t]=null});let k=t[1],E=[];for(let n=0;n<k.length;n+=1)E[n]=kt(wt(t,k,n));const D=t=>V(E[t],1,1,()=>{E[t]=null});return{c(){n=y("div"),e=y("h2"),o=x("Score: "),r=x(t[2]),l=v();for(let t=0;t<_.length;t+=1)_[t].c();i=v(),c=y("button"),c.textContent="restart",s=v(),u=y("div");for(let t=0;t<E.length;t+=1)E[t].c();b(e,"class","svelte-qae3di"),b(c,"class","svelte-qae3di"),b(n,"class","top-panel svelte-qae3di"),b(u,"class","board svelte-qae3di")},m(d,m){g(d,n,m),p(n,e),p(e,o),p(e,r),p(n,l);for(let t=0;t<_.length;t+=1)_[t].m(n,null);p(n,i),p(n,c),g(d,s,m),g(d,u,m);for(let t=0;t<E.length;t+=1)E[t].m(u,null);f=!0,h||(a=w(c,"click",t[9]),h=!0)},p(t,[e]){if((!f||4&e)&&function(t,n){n=""+n,t.data!==n&&(t.data=n)}(r,t[2]),8&e){let o;for(d=t[3],o=0;o<d.length;o+=1){const r=bt(t,d,o);_[o]?(_[o].p(r,e),Q(_[o],1)):(_[o]=_t(r),_[o].c(),Q(_[o],1),_[o].m(n,i))}for(J(),o=d.length;o<_.length;o+=1)I(o);K()}if(99&e){let n;for(k=t[1],n=0;n<k.length;n+=1){const o=wt(t,k,n);E[n]?(E[n].p(o,e),Q(E[n],1)):(E[n]=kt(o),E[n].c(),Q(E[n],1),E[n].m(u,null))}for(J(),n=k.length;n<E.length;n+=1)D(n);K()}},i(t){if(!f){for(let t=0;t<d.length;t+=1)Q(_[t]);for(let t=0;t<k.length;t+=1)Q(E[t]);f=!0}},o(t){_=_.filter(Boolean);for(let t=0;t<_.length;t+=1)V(_[t]);E=E.filter(Boolean);for(let t=0;t<E.length;t+=1)V(E[t]);f=!1},d(t){t&&m(n),$(_,t),t&&m(s),t&&m(u),$(E,t),h=!1,a()}}}function Dt(t,n,e){let o,r,l,i;function c(){e(0,o={rowIndex:null,cellIndex:null})}function s(){c(),e(1,r=xt()),e(2,l=0),e(3,i=[...yt()])}function u(t,n){o.rowIndex!==t||o.cellIndex!==n?e(0,o={rowIndex:t,cellIndex:n}):c()}async function f(t,n){if(null==o.rowIndex&&null==o.cellIndex)return;let l=!1;(function(t,n,e,o,r){const l=new ht(t.map(t=>t.map(t=>t?0:1)));return dt.search(l,l.grid[n][e],l.grid[o][r]).length>0})(r,o.rowIndex,o.cellIndex,t,n)&&(e(1,r=function(t,n,e,o,r){const l=t[n][e];return gt(gt(t,n,e,void 0),o,r,l)}(r,o.rowIndex,o.cellIndex,t,n)),l=!0);const s=await h(t,n);!function(t){return t.flat().filter(t=>void 0!==t).length+3>=81}(r)?(l&&!s&&(i.forEach(t=>{e(1,r=mt(r,t))}),e(3,i=yt())),c()):console.log("game over")}async function h(t,n){return new Promise(o=>{setTimeout(()=>{const i=function(t,n,e){if(null==t[n][e])return[];const o=[],r=[];for(let o=e;o>=0&&t[n][o]===t[n][e];o--)r.push({rowIndex:n,cellIndex:o});for(let o=e+1;o<9&&t[n][o]===t[n][e];o++)r.push({rowIndex:n,cellIndex:o});const l=[];for(let o=n;o>=0&&t[o][e]===t[n][e];o--)l.push({rowIndex:o,cellIndex:e});for(let o=n+1;o<9&&t[o][e]===t[n][e];o++)l.push({rowIndex:o,cellIndex:e});return r.length>=5&&o.push(r),l.length>=5&&o.push(l),o.flat()}(r,t,n);0!==i.length&&(e(2,l+=5+2*(i.length-5)),e(1,r=function(t,n){if(!n||0===n.length)return t;let e=t;return n.forEach(t=>e=gt(e,t.rowIndex,t.cellIndex)),e}(r,i)),o(!0)),o(!1)},500)})}s();return[o,r,l,i,s,u,f,c,h,()=>s(),(t,n)=>u(t,n),(t,n)=>f(t,n)]}class Nt extends ot{constructor(t){super(),et(this,t,Dt,Et,i,{})}}function Ct(n){let e,o;const r=new Nt({});return{c(){e=y("main"),Y(r.$$.fragment),b(e,"class","svelte-1p1sb0t")},m(t,n){g(t,e,n),Z(r,e,null),o=!0},p:t,i(t){o||(Q(r.$$.fragment,t),o=!0)},o(t){V(r.$$.fragment,t),o=!1},d(t){t&&m(e),tt(r)}}}return new class extends ot{constructor(t){super(),et(this,t,null,Ct,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
